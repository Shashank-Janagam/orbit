<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fingerprint Authentication</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
</head>
<body>
    <h2>Fingerprint Authentication</h2>
    <button onclick="registerFingerprint()">Register Fingerprint</button>
    <button onclick="authenticateFingerprint()">Login with Fingerprint</button>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
  apiKey: "AIzaSyCib5ywnEJvXXIePdWeKZtrKMIi2-Q_9sM",
  authDomain: "geo-orbit-ed7a7.firebaseapp.com",
  databaseURL: "https://geo-orbit-ed7a7-default-rtdb.firebaseio.com",
  projectId: "geo-orbit-ed7a7",
  storageBucket: "geo-orbit-ed7a7.firebasestorage.app",
  messagingSenderId: "807202826514",
  appId: "1:807202826514:web:5630f581f6f9dff46aebcb",
  measurementId: "G-H15DN69132"
};

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        async function registerFingerprint() {
            if (!window.PublicKeyCredential) {
                alert("WebAuthn is not supported on this browser.");
                return;
            }
            
            const publicKey = {
                challenge: new Uint8Array(32),
                rp: { name: "Your Website" },
                user: {
                    id: new Uint8Array(16),
                    name: "user@example.com",
                    displayName: "User",
                },
                pubKeyCredParams: [{ type: "public-key", alg: -7 }],
                authenticatorSelection: { authenticatorAttachment: "platform", userVerification: "required" },
                timeout: 60000,
                attestation: "none"
            };
            
            try {
                const credential = await navigator.credentials.create({ publicKey });
                console.log("Fingerprint Registered:", credential);
                
                // Store credential in Firestore
                const user = auth.currentUser;
                if (user) {
                    await db.collection("fingerprintCredentials").doc(user.uid).set({
                        credentialId: credential.id
                    });
                    alert("Fingerprint registered successfully!");
                } else {
                    alert("Please sign in first.");
                }
            } catch (error) {
                console.error("Fingerprint registration failed:", error);
            }
        }
        
        async function authenticateFingerprint() {
            const publicKey = {
                challenge: new Uint8Array(32),
                allowCredentials: [],
                timeout: 60000,
                userVerification: "required"
            };
            
            try {
                const assertion = await navigator.credentials.get({ publicKey });
                console.log("Fingerprint Authentication Successful:", assertion);
                alert("Login successful!");
            } catch (error) {
                console.error("Fingerprint authentication failed:", error);
            }
        }
    </script>
</body>
</html>
