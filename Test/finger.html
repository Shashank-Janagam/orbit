<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fingerprint Login with WebAuthn</title>
    <script>
        async function loginWithFingerprint() {
            if (navigator.credentials) {
                try {
                    // Step 1: Create a mock challenge (this would normally come from the server)
                    const challenge = new Uint8Array(32);
                    window.crypto.getRandomValues(challenge); // Randomly generate a challenge

                    // Step 2: WebAuthn publicKey options
                    const publicKey = {
                        challenge: challenge, // This would be a secure challenge from your server
                        timeout: 60000, // Timeout in milliseconds
                        allowCredentials: [], // Credentials (e.g., user data stored in the backend)
                        userVerification: "preferred" // Allow biometric verification
                    };

                    // Step 3: Request fingerprint authentication via WebAuthn
                    const assertion = await navigator.credentials.get({
                        publicKey: publicKey
                    });

                    console.log('Assertion received:', assertion);

                    // Step 4: Simulate sending the assertion to a server (mock)
                    alert('Fingerprint login successful!');

                } catch (error) {
                    console.error('Fingerprint login failed:', error);
                    alert('Fingerprint login failed. Make sure your fingerprint sensor is working and WebAuthn is supported.');
                }
            } else {
                alert('WebAuthn is not supported on your browser or device.');
            }
        }

        // Listen for the fingerprint login button click
        document.addEventListener('DOMContentLoaded', () => {
            const loginButton = document.getElementById('fingerprint-login');
            loginButton.addEventListener('click', loginWithFingerprint);
        });
    </script>
</head>
<body>
    <h1>Fingerprint Login with WebAuthn</h1>
    <p>Click the button below to log in using your fingerprint.</p>
    <button id="fingerprint-login">Login with Fingerprint</button>
</body>
</html>
